@using Microsoft.AspNetCore.Http

<!DOCTYPE html>
<html lang="en">
<head>
    <!-- basic -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- mobile metas -->
    @*<meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1">*@
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- site metas -->
    <title>SmartGlasses</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- bootstrap css -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <!-- style css -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- Responsive-->
    <link rel="stylesheet" href="/css/responsive.css">
    <!-- fevicon -->
    <link rel="icon" href="/images/fevicon.png" type="image/gif" />
    <!-- Scrollbar Custom CSS -->
    <link rel="stylesheet" href="/css/jquery.mCustomScrollbar.min.css">

    <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
    <link href="/css-admin/styles.css" rel="stylesheet" />

    <!-- Tweaks for older IEs-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" media="screen">

</head>

<!-- body -->
<body class="main-layout">

    <!-- loader  -->
    <!-- <div class="loader_bg">
           <div class="loader"><img src="/images/loading.gif" alt="#" /></div>
        </div> -->
    <!-- end loader -->
    <!-- header -->
    <header>
        <!-- header inner -->
        <div class="header fixed-header">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col logo_section">
                        <div class="full">
                            <div class="center-desk">
                                <!-- <div class="logo"> -->
                                <div>
                                    <a asp-controller="Home" asp-action="Index">
                                        <img src="/images/logo.png" alt="logo" />
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9">
                        <nav class="navigation navbar navbar-expand-md navbar-dark custom-nav">
                            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false" aria-label="Toggle navigation">
                                <span class="navbar-toggler-icon"></span>
                            </button>
                            <div class="collapse navbar-collapse" id="navbarsExample04">
                                <ul class="navbar-nav mr-auto">
                                    <li class="nav-item @(ViewContext.ActionDescriptor.DisplayName.Contains("Home") ? "login_btn" : "")">
                                        <a class="nav-link" asp-controller="Home" asp-action="Index">Home</a>
                                    </li>
                                    <li class="nav-item @(ViewContext.ActionDescriptor.DisplayName.Contains("Product") ? "login_btn" : "")">
                                        <a class="nav-link" asp-controller="Product" asp-action="AllProducts">Shop</a>
                                    </li>
                                    <li class="nav-item @(ViewContext.ActionDescriptor.DisplayName.Contains("About") ? "login_btn" : "")">
                                        <a class="nav-link" asp-controller="About" asp-action="Index">About</a>
                                    </li>
                                    <li class="nav-item @(ViewContext.ActionDescriptor.DisplayName.Contains("Suitable") ? "login_btn" : "")">
                                        <a class="nav-link" asp-controller="Suitable" asp-action="Index">Suitable</a>
                                    </li>
                                    <li class="nav-item @(ViewContext.ActionDescriptor.DisplayName.Contains("Contact") ? "login_btn" : "")">
                                        <a class="nav-link" asp-controller="Contact" asp-action="Index">Contact</a>
                                    </li>

                                    <partial name="_LoginPartial" />

                                    <li class="nav-item sea_icon">
                                        <button class="nav-link bg-none" id="searchLink">
                                            <i class="fa fa-search" aria-hidden="true"></i>
                                        </button>
                                        <button class="nav-link bg-none" id="closeLink" style="display: none;">
                                            <i class="fa fa-times" aria-hidden="true"></i>
                                        </button>
                                        <form class="search-box" id="searchBox" asp-controller="Product" asp-action="Index">
                                            <input name="searchString" value="@ViewBag.SearchString" type="text" id="searchInput" placeholder="Search...">
                                            <span class="search-separator"></span>
                                            <button class="search-icon" id="searchIcon" type="submit">
                                                <i class="icon-search-link bg-none fa fa-search"></i>
                                            </button>
                                        </form>
                                    </li>
                                </ul>
                            </div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
        <!-- end header inner -->
    </header>
    <!-- end header -->
    <!-- render -->
    <div class="render">
        @RenderBody()
    </div>
    <!-- end render -->
    <!--  footer -->
    <!-- Remove the container if you want to extend the Footer to full width. -->
    <footer class="text-white text-center text-lg-start bg-dark">
        <!-- Grid container -->
        <div class="container p-4">
            <!--Grid row-->
            <div class="row mt-4">
                <!--Grid column-->
                <div class="col-lg-4 col-md-12 mb-4 mb-md-0">
                    <h5 class="text-uppercase mb-4 text-white">ABOUT COMPANY</h5>

                    <p>
                        SmartGlasses offers premium eyewear solutions, blending style and function seamlessly. Our diverse collection ensures every customer finds the perfect pair. Committed to innovation, we deliver eyewear that enhances vision and fashion.
                    </p>

                    <div class="mt-4">
                        <!-- Facebook -->
                        <a href="https://www.facebook.com/xthang.2909" type="button" class="btn btn-floating btn-lg text-white"><i class="fa fa-facebook-f"></i></a>
                        <!-- Dribbble -->
                        <a type="button" class="btn btn-floating btn-lg"><i class="fa fa-dribbble"></i></a>
                        <!-- Twitter -->
                        <a type="button" class="btn btn-floating btn-lg"><i class="fa fa-twitter"></i></a>
                        <!-- Google + -->
                        <a type="button" class="btn btn-floating btn-lg text-white"><i class="fa fa-google-plus"></i></a>
                        <!-- Linkedin -->
                    </div>
                </div>
                <!--Grid column-->
                <!--Grid column-->
                <div class="col-lg-4 col-md-6 mb-4 mb-md-0">
                    <h5 class="text-uppercase mb-4 pb-1 text-white">CONTACT</h5>

                    <ul class="fa-ul" style="margin-left: 1.65em;">
                        <li class="mb-3">
                            <span class="fa-li"><i class="fa fa-home"></i></span><span class="ms-2">HUTECH-THU DUC CAMPUS</span>
                        </li>
                        <li class="mb-3">
                            <span class="fa-li"><i class="fa fa-envelope"></i></span><span class="ms-2">xthang.lib@gmail.com</span>
                        </li>
                        <li class="mb-3">
                            <span class="fa-li"><i class="fa fa-phone"></i></span><span class="ms-2">+84 522 383 757</span>
                        </li>
                    </ul>
                </div>
                <!--Grid column-->
                <!--Grid column-->
                <div class="col-lg-4 col-md-6 mb-4 mb-md-0">
                    <h5 class="text-uppercase mb-4 text-white">OPENING HOURS</h5>

                    <table class="table text-center text-white">
                        <tbody class="fw-normal">
                            <tr>
                                <td>Mon - Thu:</td>
                                <td>8am - 9pm</td>
                            </tr>
                            <tr>
                                <td>Fri - Sat:</td>
                                <td>8am - 1am</td>
                            </tr>
                            <tr>
                                <td>Sunday:</td>
                                <td>9am - 10pm</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!--Grid column-->
            </div>
            <!--Grid row-->
        </div>
        <!-- Grid container -->

    </footer>
    <!-- End of .container -->
    <!-- end footer -->

    <!-- Javascript files-->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/popper.min.js"></script>
    <script src="/js/bootstrap.bundle.min.js"></script>
    @*<script src="/js/jquery-3.0.0.min.js"></script>*@

    <!-- sidebar -->
    <script src="/js/jquery.mCustomScrollbar.concat.min.js"></script>
    <script src="/js/custom.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    @*<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>*@
    <script src="/js-admin/scripts.js"></script>
    @*<script src="/assets/demo/chart-area-demo.js"></script>
        <script src="/assets/demo/chart-bar-demo.js"></script>*@
    <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
    <script src="/js-admin/datatables-simple-demo.js"></script>

    <!-- Render additional scripts from views if available -->
    @RenderSection("Scripts", required: false)

    <script>$(document).ready(function () {

            var searchString = $('#searchInput').val().trim(); // Lấy giá trị từ ô input và loại bỏ khoảng trắng ở đầu và cuối
            //console.log("Search string:", searchString); // Log giá trị của searchString ra console

            //sessionStorage.setItem('searchString', searchString);

            //$('#searchBox').submit(function (event) {
            //    event.preventDefault();
            //    console.log("Remove");

            //    var searchString = $('#searchInput').val().trim(); // Lấy giá trị từ ô input và loại bỏ khoảng trắng ở đầu và cuối
            //    if (!IsNullOrEmpty(searchString)) { // Kiểm tra xem ô input có giá trị không

            //    }
            //});

            //$('#searchBox').submit(function (event) {
            //    //sessionStorage.setItem('searchString', searchString);
            //    if (!String.IsNullOrEmpty(searchString)) { // Kiểm tra xem giá trị tìm kiếm có rỗng không
            //        // Nếu không rỗng, gán giá trị cho session
            //        HttpContext.Session.SetString("searchString", searchString);
            //        console.log("Set");

            //    } else {
            //        // Nếu giá trị tìm kiếm là rỗng, xóa giá trị của session
            //        HttpContext.Session.Remove("searchString");

            //        console.log("Remove");

            //    }
            //});

            $("#searchLink").click(function (e) {
                e.preventDefault();
                $("#searchBox").fadeToggle(); // Hiển thị ô tìm kiếm
                $("#searchLink").hide(); // Ẩn lại SearchIcon
                $("#closeLink").show(); // Hiển thị CloseIcon
                $("#searchInput").focus(); // Trỏ chuột vào input
                $("#searchInput").select(); // Chọn toàn bộ giá trị trong ô tìm kiếm khi mở
            });

            $("#closeLink").click(function () {
                $("#searchBox").fadeOut(); // Đóng ô tìm kiếm
                $("#closeLink").hide(); // Ẩn nút close
                $("#searchLink").show(); // Hiển thị nút search
            });

            $(document).click(function (e) {
                // Nếu click ra ngoài ô tìm kiếm, đóng ô tìm kiếm đi
                if (!$(e.target).closest('#searchBox').length && !$(e.target).closest('#searchLink').length) {
                    $("#searchBox").fadeOut();
                    $("#searchLink").show(); // Hiển thị lại SearchIcon khi đóng ô tìm kiếm
                    $("#closeLink").hide(); // Ẩn CloseIcon khi đóng ô tìm kiếm
                }
            });

            function getSearchString() {
                // Gửi yêu cầu GET đến phương thức GetSearchString của ProductController
                return fetch('/Product/GetSearchString')
                    .then(response => response.text()) // Chuyển đổi phản hồi thành dạng văn bản
                    .then(data => {
                        // Trả về giá trị tìm kiếm từ session
                        return data.trim();
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        return ''; // Trả về giá trị rỗng nếu có lỗi xảy ra
                    });
            }

            //var savedSearchString = sessionStorage.getItem('searchString');
            //if (savedSearchString) {
            //    $("#searchInput").val(savedSearchString);
            //}

            // Gọi hàm getSearchString để lấy giá trị tìm kiếm từ session
            getSearchString().then(savedSearchString => {
                // Kiểm tra nếu giá trị tìm kiếm có tồn tại
                if (savedSearchString) {
                    // Thiết lập giá trị tìm kiếm cho ô input
                    $("#searchInput").val(savedSearchString);
                }
            });

            // Di chuyển con trỏ vào cuối ô input khi trang được tải lại
            var input = $('#searchInput');
            if (input.val()) {
                input.focus();
                input[0].setSelectionRange(input.val().length, input.val().length);
            }

        });</script>
</body>
</html>
